
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Plotting in Detail &#8212; penguins  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Plotting Cookbook" href="cookbook.html" />
    <link rel="prev" title="1D Plotting in Detail" href="plot1d.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="d-plotting-in-detail">
<h1>2D Plotting in Detail<a class="headerlink" href="#d-plotting-in-detail" title="Permalink to this headline">¶</a></h1>
<p>Many concepts of the interface here are exactly analogous to that for 1D spectra, so will not be detailed here again.</p>
<div class="section" id="step-1-staging-spectra">
<h2>Step 1: Staging spectra<a class="headerlink" href="#step-1-staging-spectra" title="Permalink to this headline">¶</a></h2>
<p>Like its 1D counterpart, the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Dataset2D.stage</span></code> method also delegates to <a class="reference internal" href="#penguins.pgplot.stage2d" title="penguins.pgplot.stage2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">penguins.pgplot.stage2d()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># These are entirely equivalent</span>
<span class="n">ds2</span><span class="o">.</span><span class="n">stage</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>    <span class="c1"># ds2: a 2D dataset</span>
<span class="n">pg</span><span class="o">.</span><span class="n">pgplot</span><span class="o">.</span><span class="n">stage2d</span><span class="p">(</span><span class="n">ds2</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Multiple spectra can be plotted by staging each of them individually.</p>
<dl class="py function">
<dt id="penguins.pgplot.stage2d">
<code class="sig-prename descclassname">penguins.pgplot.</code><code class="sig-name descname">stage2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">f1_bounds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">f2_bounds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">levels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">colors</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">label</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot_options</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#penguins.pgplot.stage2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the information provided to create a <code class="xref py py-class docutils literal notranslate"><span class="pre">penguins.pgplot.PlotObject2D</span></code> object, which is then appended to the plot holding area.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – A 2D dataset object.</p></li>
<li><p><strong>f1_bounds</strong> – <p><em>(optional)</em> A tuple of floats <code class="docutils literal notranslate"><span class="pre">(lower,</span> <span class="pre">upper)</span></code>, or a string <code class="docutils literal notranslate"><span class="pre">&quot;lower..upper&quot;</span></code>, specifying the section of the indirect dimension to plot. Both should be chemical shifts. If either <code class="docutils literal notranslate"><span class="pre">lower</span></code> or <code class="docutils literal notranslate"><span class="pre">upper</span></code> are omitted, then the upper (upper) bound is the rightmost (or leftmost) edge of the spectrum. If not provided, defaults to the entire spectrum.</p>
<p><br />
Note that, as before, the <code class="docutils literal notranslate"><span class="pre">bounds</span></code> parameters do not merely affect the <em>plot limits</em>. They restrict the portion of the spectrum which is actually plotted (and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> chooses sensible plot limits to reflect that).</p>
</p></li>
<li><p><strong>f2_bounds</strong> – <em>(optional)</em> Same as above, but for the direct dimension.</p></li>
<li><p><strong>levels</strong> – <p><em>(optional)</em> A tuple <code class="docutils literal notranslate"><span class="pre">(baselev,</span> <span class="pre">increment,</span> <span class="pre">nlev)</span></code> specifying the levels at which to draw contours. <code class="docutils literal notranslate"><span class="pre">baselev</span></code> and <code class="docutils literal notranslate"><span class="pre">increment</span></code> are floats; <code class="docutils literal notranslate"><span class="pre">nlev</span></code> is an int. This is directly analogous  to the contour levels in TopSpin’s <code class="docutils literal notranslate"><span class="pre">edlev</span></code> dialog box. Contours are drawn at <code class="docutils literal notranslate"><span class="pre">±(baselev</span> <span class="pre">*</span> <span class="pre">(increment</span> <span class="pre">**</span> <span class="pre">N))</span></code> where <code class="docutils literal notranslate"><span class="pre">N</span></code> ranges from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">nlev</span> <span class="pre">-</span> <span class="pre">1</span></code>.</p>
<p><br />
The default <code class="docutils literal notranslate"><span class="pre">baselev</span></code> is chosen individually for each spectrum, according to TopSpin’s algorithm of <code class="docutils literal notranslate"><span class="pre">(35</span> <span class="pre">*</span> <span class="pre">stdev(data))</span></code> (see <em>“Processing Commands and Parameters”</em> documentation). <code class="docutils literal notranslate"><span class="pre">increment</span></code> by default is 1.5 and <code class="docutils literal notranslate"><span class="pre">nlev</span></code> is 10. Any of the three parameters can be passed as <code class="docutils literal notranslate"><span class="pre">None</span></code> in order to use the defaults.</p>
<p><br />
<code class="docutils literal notranslate"><span class="pre">baselev</span></code> is, by far, the most likely parameter to be customised. Therefore, instead of passing a tuple of <code class="docutils literal notranslate"><span class="pre">(baselev,</span> <span class="pre">None,</span> <span class="pre">None)</span></code>, you can also pass a single float <code class="docutils literal notranslate"><span class="pre">baselev</span></code>.</p>
</p></li>
<li><p><strong>colors</strong> – <p><em>(optional)</em> A tuple of valid <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> colors <code class="docutils literal notranslate"><span class="pre">(positive,</span> <span class="pre">negative)</span></code>. The colours will be used for positive and negative contours respectively. See <a class="reference external" href="https://matplotlib.org/tutorials/colors/colors.html" title="(in Matplotlib v3.2.1)"><span>Specifying Colors</span></a> for more information. The default colours are drawn from Seaborn’s “deep” palette (see Seaborn’s <a class="reference external" href="https://seaborn.pydata.org/tutorial/color_palettes.html" title="(in seaborn v0.10.1)"><span>Choosing color palettes</span></a>).</p>
<p><br />
Note that as of now there is no way to disable contours of a particular sign. The easiest way around that is to make the unwanted contour have the same colour as the figure background.</p>
</p></li>
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <em>(optional)</em> A string to display in the legend of the plot. See below for an example of how this looks.</p></li>
<li><p><strong>plot_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <em>(optional)</em> Key-value options which are passed on directly to <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.contour.html#matplotlib.pyplot.contour" title="(in Matplotlib v3.2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">plt.contour()</span></code></a>. Note that the <code class="docutils literal notranslate"><span class="pre">colors</span></code> parameter will override the corresponding key in <code class="docutils literal notranslate"><span class="pre">plot_options</span></code>, if present.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<p>As a slightly contrived example, here we stage the same HMBC dataset four times with different values of <code class="docutils literal notranslate"><span class="pre">baselev</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;data/pt2&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># HMBC</span>
<span class="c1"># Split spectrum into four portions</span>
<span class="n">bottom_f1</span><span class="p">,</span> <span class="n">top_f1</span> <span class="o">=</span> <span class="s2">&quot;100..&quot;</span><span class="p">,</span> <span class="s2">&quot;..100&quot;</span>
<span class="n">left_f2</span><span class="p">,</span> <span class="n">right_f2</span> <span class="o">=</span> <span class="s2">&quot;4.5..&quot;</span><span class="p">,</span> <span class="s2">&quot;..4.5&quot;</span>
<span class="c1"># To make this less boring you could use a double listcomp or</span>
<span class="c1"># itertools.product(), but for now we&#39;ll do it the repetitive way.</span>
<span class="c1"># Recall levels=1e2 is the same as levels=(1e2, None, None).</span>
<span class="n">d</span><span class="o">.</span><span class="n">stage</span><span class="p">(</span><span class="n">f1_bounds</span><span class="o">=</span><span class="n">bottom_f1</span><span class="p">,</span> <span class="n">f2_bounds</span><span class="o">=</span><span class="n">left_f2</span><span class="p">,</span>  <span class="n">levels</span><span class="o">=</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">stage</span><span class="p">(</span><span class="n">f1_bounds</span><span class="o">=</span><span class="n">top_f1</span><span class="p">,</span>    <span class="n">f2_bounds</span><span class="o">=</span><span class="n">left_f2</span><span class="p">,</span>  <span class="n">levels</span><span class="o">=</span><span class="mf">1e3</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">stage</span><span class="p">(</span><span class="n">f1_bounds</span><span class="o">=</span><span class="n">bottom_f1</span><span class="p">,</span> <span class="n">f2_bounds</span><span class="o">=</span><span class="n">right_f2</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mf">1e4</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">stage</span><span class="p">(</span><span class="n">f1_bounds</span><span class="o">=</span><span class="n">top_f1</span><span class="p">,</span>    <span class="n">f2_bounds</span><span class="o">=</span><span class="n">right_f2</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mf">1e5</span><span class="p">)</span>
<span class="c1"># Construct and display</span>
<span class="n">pg</span><span class="o">.</span><span class="n">mkplot</span><span class="p">();</span> <span class="n">pg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot2d_baselev.png" class="align-center" src="_images/plot2d_baselev.png" />
<p>Notice that <code class="docutils literal notranslate"><span class="pre">baselev</span></code> in the bottom-left and top-left sectors are certainly too low; we are plotting mostly noise. The top-right sector with <code class="docutils literal notranslate"><span class="pre">baselev=1e5</span></code> doesn’t pick up any noise, but the peaks are getting a little bit difficult to see. The best value of <code class="docutils literal notranslate"><span class="pre">baselev</span></code> is probably close to <code class="docutils literal notranslate"><span class="pre">1e4</span></code> as seen in the bottom-right. It turns out that TopSpin’s algorithm suggests a value of approximately <code class="docutils literal notranslate"><span class="pre">1.9e4</span></code>.</p>
<p>The next section contains more information about how to choose a base level.</p>
</div>
<div class="section" id="choosing-base-levels">
<h2>Choosing base levels<a class="headerlink" href="#choosing-base-levels" title="Permalink to this headline">¶</a></h2>
<p>Choosing a base level for a 2D plot can be tricky. Even though the TopSpin algorithm is usually a decent initial guess, there is often a slightly better value. Instead of using trial-and-error to find this, there are a couple of ways to do this efficiently.</p>
<p>The first is to open the spectrum in TopSpin. Scroll up or down to decrease or increase the base level to a comfortable point, then type in <code class="docutils literal notranslate"><span class="pre">edlev</span></code> at the TopSpin command line and note down the base level. This number can be directly passed to <code class="docutils literal notranslate"><span class="pre">stage2d()</span></code>. You do need to be careful about which number you choose. Sometimes these are the same, but sometimes they aren’t:</p>
<img alt="_images/topspin_edlev.png" class="no-scaled-link align-center" src="_images/topspin_edlev.png" style="width: 70%;" />
<p>Alternatively, penguins provides a <code class="xref py py-meth docutils literal notranslate"><span class="pre">find_baselev()</span></code> method on <a class="reference internal" href="reference.html#penguins.dataset.Dataset2D" title="penguins.dataset.Dataset2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset2D</span></code></a> classes which opens an interactive plot window where you can adjust <code class="docutils literal notranslate"><span class="pre">baselev</span></code> using a slider:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hmbc</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;data/pt2&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">hmbc</span><span class="o">.</span><span class="n">find_baselev</span><span class="p">()</span>     <span class="c1"># opens the following window</span>
</pre></div>
</div>
<img alt="_images/find_baselev.png" class="align-center" src="_images/find_baselev.png" />
<p>The slider is logarithmic and the value displayed on the right is the base-10 logarithm of the real <code class="docutils literal notranslate"><span class="pre">baselev</span></code>. The initial <code class="docutils literal notranslate"><span class="pre">baselev</span></code> is given by TopSpin’s algorithm (<code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">**</span> <span class="pre">4.27</span> <span class="pre">≈</span> <span class="pre">1.9e4</span></code>, as before). After you find a comfortable value, click “OK”; penguins will print the final value of <code class="docutils literal notranslate"><span class="pre">baselev</span></code> to standard output. Note that this method does <em>not</em> work in Jupyter notebooks.</p>
<p>Under the hood, the <code class="xref py py-meth docutils literal notranslate"><span class="pre">find_baselev()</span></code> method calls the <a class="reference internal" href="#penguins.pgplot._make_contour_slider" title="penguins.pgplot._make_contour_slider"><code class="xref py py-func docutils literal notranslate"><span class="pre">_make_contour_slider()</span></code></a> function with the dataset object as the first parameter.</p>
<dl class="py function">
<dt id="penguins.pgplot._make_contour_slider">
<code class="sig-prename descclassname">penguins.pgplot.</code><code class="sig-name descname">_make_contour_slider</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">increment</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nlev</span><span class="o">=</span><span class="default_value">4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#penguins.pgplot._make_contour_slider" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an interactive plot window with a slider controlling <code class="docutils literal notranslate"><span class="pre">baselev</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – 2D dataset object.</p></li>
<li><p><strong>increment</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – <em>(optional)</em> Desired increment. Defaults to <code class="docutils literal notranslate"><span class="pre">(1.5</span> <span class="pre">**</span> <span class="pre">10)</span> <span class="pre">**</span> <span class="pre">(1</span> <span class="pre">/</span> <span class="pre">nlev)</span></code>. This value is chosen so that the <code class="docutils literal notranslate"><span class="pre">nlev</span></code> contours can cover a similar dynamic range as with <code class="docutils literal notranslate"><span class="pre">increment=1.5</span></code> and <code class="docutils literal notranslate"><span class="pre">nlev=10</span></code>.</p></li>
<li><p><strong>nlev</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – <em>(optional)</em> Desired number of contour levels. Note that every time the slider value is changed, <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> has to redraw all the contours from scratch. Therefore, it is advisable to keep this number fairly small (the default of 4 seems to work reasonably well). Anecdotally, the quality of the plot does not suffer very much.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The chosen <code class="docutils literal notranslate"><span class="pre">baselev</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_baselev()</span></code> actually does return the chosen value of <code class="docutils literal notranslate"><span class="pre">baselev</span></code>, so you <em>could</em> do something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">baselev</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">find_baselev</span><span class="p">()</span>
<span class="n">ds</span><span class="o">.</span><span class="n">stage</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="n">baselev</span><span class="p">);</span> <span class="n">pg</span><span class="o">.</span><span class="n">mkplot</span><span class="p">();</span> <span class="n">pg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>However, we <em>don’t</em> recommend doing this unless you really want to, because it means that your plot generation is <em>not reproducible</em> (it depends on what value you drag the slider to, and that is highly unlikely to be the same every time). That’s why we also print out the nicely formatted value for you: so that you can write it down and pass it as the <code class="docutils literal notranslate"><span class="pre">levels</span></code> parameter.</p>
</div>
</div>
<div class="section" id="step-2-constructing-the-plot">
<h2>Step 2: Constructing the plot<a class="headerlink" href="#step-2-constructing-the-plot" title="Permalink to this headline">¶</a></h2>
<p>Plot construction is done using <a class="reference internal" href="plot1d.html#penguins.mkplot" title="penguins.mkplot"><code class="xref py py-func docutils literal notranslate"><span class="pre">mkplot()</span></code></a>. If the holding area consists of 2D spectra, then it delegates to <code class="xref py py-func docutils literal notranslate"><span class="pre">_plot2d()</span></code>.</p>
<dl class="py function">
<dt>
<code class="sig-prename descclassname">penguins.</code><code class="sig-name descname">mkplot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">axes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figstyle</span><span class="o">=</span><span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">0, 0</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xlabel</span><span class="o">=</span><span class="default_value">'$f_2$ (ppm)'</span></em>, <em class="sig-param"><span class="n">ylabel</span><span class="o">=</span><span class="default_value">'$f_1$ (ppm)'</span></em>, <em class="sig-param"><span class="n">legend_loc</span><span class="o">=</span><span class="default_value">'best'</span></em>, <em class="sig-param"><span class="n">close</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">empty_pha</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span></dt>
<dd><p>Calls <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.contour.html#matplotlib.pyplot.contour" title="(in Matplotlib v3.2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">plt.contour()</span></code></a> on each spectrum in the holding area. Also calls several <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> functions in order to make the plot more aesthetically pleasing. Finally, empties the plot holding area if <code class="docutils literal notranslate"><span class="pre">empty_pha</span></code> is set to True.</p>
<p>All keyword arguments below are optional:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> – <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></a> object to plot the graph on. If not given, defaults to the currently active axes. (The most likely scenario is that there <em>isn’t</em> an active axes, so <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.contour.html#matplotlib.pyplot.contour" title="(in Matplotlib v3.2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">plt.contour()</span></code></a> will create one.)</p></li>
<li><p><strong>figsize</strong> – Tuple of floats specifying <code class="docutils literal notranslate"><span class="pre">(width,</span> <span class="pre">height)</span></code> of plot in inches.</p></li>
<li><p><strong>figstyle</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>Specifies the overall plot style.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code> enables minor ticks, makes the axes slightly thicker than usual, and calls <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.tight_layout.html#matplotlib.pyplot.tight_layout" title="(in Matplotlib v3.2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">plt.tight_layout()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;mpl_natural&quot;</span></code> does not change any settings from the original.</p></li>
</ul>
<p>There are no other styles right now, but this list may be expanded in future.</p>
</p></li>
<li><p><strong>offset</strong> – Tuple of floats <code class="docutils literal notranslate"><span class="pre">(f1_offset,</span> <span class="pre">f2_offset)</span></code> specifying offset between adjacent spectra. If <code class="docutils literal notranslate"><span class="pre">f1_offset</span></code> (or <code class="docutils literal notranslate"><span class="pre">f2_offset</span></code>) is positive, then later spectra are shifted upwards (or rightwards). Also, the default of this argument is a tuple <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code>, but Sphinx doesn’t display the parentheses in the function signature correctly.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Plot title.</p></li>
<li><p><strong>xlabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Label for <em>x</em>-axis.</p></li>
<li><p><strong>ylabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Label for <em>y</em>-axis.</p></li>
<li><p><strong>legend_loc</strong> – Legend location. Passed directly as the <code class="docutils literal notranslate"><span class="pre">loc</span></code> parameter to <a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="(in Matplotlib v3.2.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">plt.legend</span></code></a>, where a full description can be found. Defaults to <code class="docutils literal notranslate"><span class="pre">&quot;best&quot;</span></code>, which means that <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> will attempt to choose a position that doesn’t collide with the existing plots.</p></li>
<li><p><strong>close</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Close all previously used figures before constructing a new plot. This shouldn’t be changed by the end user.</p></li>
<li><p><strong>empty_pha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Empty the holding area after constructing a plot. This also causes the <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> colour generator to restart. Setting this to False can be useful if one wants to construct several figures by adding one spectrum at at time, since you don’t have to stage the first dataset every time after calling <a class="reference internal" href="plot1d.html#penguins.show" title="penguins.show"><code class="xref py py-func docutils literal notranslate"><span class="pre">show()</span></code></a> or <a class="reference internal" href="plot1d.html#penguins.savefig" title="penguins.savefig"><code class="xref py py-func docutils literal notranslate"><span class="pre">savefig()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of (<a class="reference external" href="https://matplotlib.org/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="(in Matplotlib v3.2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Figure</span></code></a>, <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Axes</span></code></a>) objects corresponding to the plot.</p>
</dd>
</dl>
</dd></dl>

<p>As before, <a class="reference internal" href="plot1d.html#penguins.mkplot" title="penguins.mkplot"><code class="xref py py-func docutils literal notranslate"><span class="pre">mkplot()</span></code></a> returns <code class="docutils literal notranslate"><span class="pre">(fig,</span> <span class="pre">ax)</span></code> so that various <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> methods can be used.</p>
<p>Here’s an example where we plot the same HSQC spectrum four times but give the plot a nonzero offset to make it seem as if the peaks are shifting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;data/rot1&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># HSQC</span>
<span class="c1"># Make some colours</span>
<span class="n">temps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">240</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">260</span><span class="p">,</span> <span class="mi">270</span><span class="p">]</span>  <span class="c1"># in K</span>
<span class="n">blues</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;#00</span><span class="si">{</span><span class="n">cc</span><span class="si">}</span><span class="s2">ff&quot;</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="s2">&quot;55&quot;</span><span class="p">,</span> <span class="s2">&quot;a6&quot;</span><span class="p">,</span> <span class="s2">&quot;ea&quot;</span><span class="p">]]</span>
<span class="n">reds</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;#ff</span><span class="si">{</span><span class="n">cc</span><span class="si">}</span><span class="s2">00&quot;</span> <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;00&quot;</span><span class="p">,</span> <span class="s2">&quot;55&quot;</span><span class="p">,</span> <span class="s2">&quot;a6&quot;</span><span class="p">,</span> <span class="s2">&quot;ea&quot;</span><span class="p">]]</span>
<span class="c1"># Stage each of them with different colours</span>
<span class="k">for</span> <span class="n">temp</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> <span class="n">red</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span> <span class="n">blues</span><span class="p">,</span> <span class="n">reds</span><span class="p">):</span>
    <span class="n">d</span><span class="o">.</span><span class="n">stage</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="p">(</span><span class="n">blue</span><span class="p">,</span> <span class="n">red</span><span class="p">),</span>
            <span class="n">f1_bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
            <span class="n">f2_bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">4.2</span><span class="p">),</span>
            <span class="n">levels</span><span class="o">=</span><span class="mf">2.8e5</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s2"> K&quot;</span><span class="p">)</span>
<span class="c1"># Separate each plot a little bit</span>
<span class="n">pg</span><span class="o">.</span><span class="n">mkplot</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">),</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="n">pg</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/plot2d_offset.png" src="_images/plot2d_offset.png" />
<p>Of course, if your peaks are <em>truly</em> shifting, then you should load each separately (e.g. by adding an <code class="docutils literal notranslate"><span class="pre">expno</span></code> list as another argument to <code class="docutils literal notranslate"><span class="pre">zip()</span></code>) and you will not need to put in a fake <code class="docutils literal notranslate"><span class="pre">offset</span></code>. And you can also get the temperature via the <code class="docutils literal notranslate"><span class="pre">TE</span></code> parameter (i.e. <code class="docutils literal notranslate"><span class="pre">d.stage(...,</span> <span class="pre">label=str(d[&quot;te&quot;]))</span></code>).</p>
<p>PS: If anybody wants to contribute a series of real HSQC spectra for this plot please get in touch.</p>
</div>
<div class="section" id="step-3-displaying-the-plot">
<h2>Step 3: Displaying the plot<a class="headerlink" href="#step-3-displaying-the-plot" title="Permalink to this headline">¶</a></h2>
<p>This step is the same as in the 1D case. For more information, please see the <a class="reference internal" href="plot1d.html#plot1d-display"><span class="std std-ref">corresponding section</span></a> in the 1D chapter.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">penguins</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot1d.html">1D Plotting in Detail</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2D Plotting in Detail</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#step-1-staging-spectra">Step 1: Staging spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="#choosing-base-levels">Choosing base levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-2-constructing-the-plot">Step 2: Constructing the plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-3-displaying-the-plot">Step 3: Displaying the plot</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Plotting Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="nus.html">Non-Uniform Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="topspin.html">TopSpin directories</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Full reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="plot1d.html" title="previous chapter">1D Plotting in Detail</a></li>
      <li>Next: <a href="cookbook.html" title="next chapter">Plotting Cookbook</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Jonathan Yong.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/plot2d.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>